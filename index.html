<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Esdiac â€” KMP Architecture v2</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">
<style>
:root {
  --navy:    #091929;
  --navy2:   #0E2338;
  --navy3:   #163150;
  --blue:    #2D7DD2;
  --blue2:   #4A90D9;
  --cyan:    #38C9E8;
  --white:   #ECF4FC;
  --muted:   #6A8FAD;
  --border:  rgba(56,201,232,0.18);
  --green:   #3DD68C;
  --orange:  #FFAB4A;
  --purple:  #9B72F5;
  --pink:    #F472B6;
  --red:     #F87171;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth}
body{
  background:var(--navy);color:var(--white);
  font-family:'Syne',sans-serif;min-height:100vh;overflow-x:hidden;
  background-image:
    radial-gradient(ellipse 70% 55% at 15% 0%, rgba(45,125,210,.1) 0%,transparent 65%),
    radial-gradient(ellipse 50% 40% at 85% 100%, rgba(56,201,232,.07) 0%,transparent 60%);
}
body::before{
  content:'';position:fixed;inset:0;pointer-events:none;z-index:0;
  background-image:
    linear-gradient(rgba(56,201,232,.03) 1px,transparent 1px),
    linear-gradient(90deg,rgba(56,201,232,.03) 1px,transparent 1px);
  background-size:48px 48px;
}

/* â”€â”€ HEADER â”€â”€ */
header{
  position:relative;z-index:10;padding:44px 64px 36px;
  border-bottom:1px solid var(--border);
  display:flex;align-items:flex-end;justify-content:space-between;
  background:rgba(9,25,41,.75);backdrop-filter:blur(14px);
}
.logo-wrap{display:flex;align-items:center;gap:18px}
.logo{
  width:54px;height:54px;border-radius:13px;
  background:linear-gradient(135deg,var(--blue) 0%,var(--cyan) 100%);
  display:grid;place-items:center;font-size:21px;font-weight:800;color:#fff;
  box-shadow:0 0 28px rgba(56,201,232,.5);
  animation:logoGlow 3.5s ease infinite;
}
@keyframes logoGlow{0%,100%{box-shadow:0 0 20px rgba(56,201,232,.4)}50%{box-shadow:0 0 44px rgba(56,201,232,.7)}}
h1{font-size:26px;font-weight:800;letter-spacing:-.5px;line-height:1}
h1 span{color:var(--cyan)}
.tagline{font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--muted);margin-top:5px;letter-spacing:.4px}
.badges{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end}
.badge{
  padding:5px 12px;border-radius:20px;font-size:11px;font-weight:600;
  letter-spacing:.5px;border:1px solid;font-family:'JetBrains Mono',monospace;
}
.bkmp {color:var(--cyan);  border-color:rgba(56,201,232,.4); background:rgba(56,201,232,.07)}
.bcmp {color:var(--green); border-color:rgba(61,214,140,.4); background:rgba(61,214,140,.07)}
.bmvvm{color:var(--orange);border-color:rgba(255,171,74,.4);  background:rgba(255,171,74,.07)}
.bbuild{color:var(--purple);border-color:rgba(155,114,245,.4);background:rgba(155,114,245,.07)}

/* â”€â”€ TABS â”€â”€ */
.tabs{
  display:flex;gap:0;padding:0 64px;
  border-bottom:1px solid var(--border);
  background:rgba(9,25,41,.65);backdrop-filter:blur(10px);
  position:sticky;top:0;z-index:20;overflow-x:auto;
}
.tab{
  padding:15px 24px;background:none;border:none;
  font-family:'Syne',sans-serif;font-size:13px;font-weight:600;
  color:var(--muted);cursor:pointer;border-bottom:2px solid transparent;
  transition:all .18s;letter-spacing:.3px;white-space:nowrap;
}
.tab:hover{color:var(--white)}
.tab.on{color:var(--cyan);border-bottom-color:var(--cyan)}

/* â”€â”€ PANELS â”€â”€ */
.panel{display:none;padding:48px 64px;position:relative;z-index:1}
.panel.on{display:block}
@keyframes fadeUp{from{opacity:0;transform:translateY(14px)}to{opacity:1;transform:translateY(0)}}
.panel.on>*{animation:fadeUp .35s ease both}
.panel.on>*:nth-child(2){animation-delay:.05s}
.panel.on>*:nth-child(3){animation-delay:.1s}
.panel.on>*:nth-child(4){animation-delay:.15s}

/* â”€â”€ SECTION LABELS â”€â”€ */
.sec{
  font-size:11px;font-weight:700;letter-spacing:3px;text-transform:uppercase;
  color:var(--cyan);margin-bottom:28px;display:flex;align-items:center;gap:12px;
}
.sec::after{content:'';flex:1;height:1px;background:var(--border)}

/* â”€â”€ CARDS â”€â”€ */
.card{
  background:rgba(14,35,56,.8);border:1px solid var(--border);
  border-radius:14px;padding:24px;backdrop-filter:blur(6px);
  transition:transform .2s,border-color .2s,box-shadow .2s;
}
.card:hover{transform:translateY(-2px);border-color:rgba(45,125,210,.5);box-shadow:0 10px 36px rgba(0,0,0,.35)}
.card-cat{font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;margin-bottom:10px}
.card-title{font-size:17px;font-weight:700;margin-bottom:7px}
.card-body{font-size:13px;color:var(--muted);line-height:1.65}

/* â”€â”€ GRIDS â”€â”€ */
.g2{display:grid;grid-template-columns:1fr 1fr;gap:18px}
.g3{display:grid;grid-template-columns:repeat(3,1fr);gap:18px}
.g4{display:grid;grid-template-columns:repeat(4,1fr);gap:14px}
.gauto{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:16px}

/* â”€â”€ PRODUCT GRID â”€â”€ */
.prod-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin-bottom:36px}
.prod-col{background:rgba(14,35,56,.7);border:1px solid var(--border);border-radius:14px;overflow:hidden}
.prod-head{padding:18px 22px;font-size:14px;font-weight:800;display:flex;align-items:center;gap:10px}
.prod-head .dot{width:9px;height:9px;border-radius:50%}
.prod-items{padding:6px 22px 18px}
.prod-item{
  padding:8px 0;border-bottom:1px solid var(--border);
  font-size:12px;display:flex;align-items:center;gap:8px;color:var(--muted);
}
.prod-item:last-child{border-bottom:none}
.prod-item::before{content:'â†’';font-size:10px}
.call .prod-head{color:var(--cyan); background:rgba(56,201,232,.08)} .call .prod-item::before{color:var(--cyan)}
.data .prod-head{color:var(--green);background:rgba(61,214,140,.08)} .data .prod-item::before{color:var(--green)}
.pay  .prod-head{color:var(--orange);background:rgba(255,171,74,.08)} .pay  .prod-item::before{color:var(--orange)}

/* â”€â”€ CLEAN ARCH LAYERS â”€â”€ */
.layers{display:flex;flex-direction:column;gap:5px;max-width:880px;margin:0 auto 44px}
.layer{
  border-radius:12px;padding:16px 28px;display:flex;align-items:center;
  justify-content:space-between;border:1px solid;transition:all .2s;cursor:default;
}
.layer:hover{transform:scaleX(1.01)}
.layer-left{display:flex;align-items:center;gap:14px}
.layer-icon{font-size:20px}
.layer-name{font-size:14px;font-weight:700}
.layer-sub{font-size:11px;color:var(--muted);margin-top:2px;font-family:'JetBrains Mono',monospace}
.layer-tags{display:flex;gap:7px;flex-wrap:wrap;justify-content:flex-end}
.tag{padding:3px 9px;border-radius:5px;font-size:10px;font-family:'JetBrains Mono',monospace;font-weight:500}
.l-ui{background:rgba(56,201,232,.07);border-color:rgba(56,201,232,.3)} .l-ui .layer-name{color:var(--cyan)} .tag-ui{background:rgba(56,201,232,.12);color:var(--cyan)}
.l-pres{background:rgba(155,114,245,.07);border-color:rgba(155,114,245,.3)} .l-pres .layer-name{color:var(--purple)} .tag-pres{background:rgba(155,114,245,.12);color:var(--purple)}
.l-domain{background:rgba(61,214,140,.07);border-color:rgba(61,214,140,.3)} .l-domain .layer-name{color:var(--green)} .tag-domain{background:rgba(61,214,140,.12);color:var(--green)}
.l-data{background:rgba(255,171,74,.07);border-color:rgba(255,171,74,.3)} .l-data .layer-name{color:var(--orange)} .tag-data{background:rgba(255,171,74,.12);color:var(--orange)}
.arrow-dn{text-align:center;color:var(--border);font-size:16px;margin:-1px 0}

/* â”€â”€ MVVM FLOW â”€â”€ */
.mvvm-flow{display:flex;align-items:center;justify-content:center;gap:0;flex-wrap:nowrap;margin:28px 0 36px;overflow-x:auto;padding:16px}
.mvvm-node{
  background:rgba(14,35,56,.9);border-radius:14px;padding:24px 20px;
  min-width:185px;text-align:center;border:1.5px solid;flex-shrink:0;
}
.mvvm-icon{font-size:28px;margin-bottom:10px}
.mvvm-title{font-size:14px;font-weight:700;margin-bottom:7px}
.mvvm-items{font-size:11px;color:var(--muted);line-height:1.9;font-family:'JetBrains Mono',monospace}
.mvvm-arrow{padding:0 14px;display:flex;flex-direction:column;align-items:center;gap:3px;flex-shrink:0}
.mvvm-arrow span{font-size:18px;color:var(--blue)}
.mvvm-arrow small{font-size:9px;color:var(--muted);text-align:center;white-space:nowrap;font-family:'JetBrains Mono',monospace}

/* â”€â”€ CODE BLOCK â”€â”€ */
.code{
  background:rgba(5,14,26,.95);border:1px solid rgba(56,201,232,.25);
  border-radius:12px;padding:24px 28px;font-family:'JetBrains Mono',monospace;
  font-size:12px;line-height:1.9;overflow-x:auto;margin-bottom:24px;
}
.kw {color:#9B72F5} /* keywords */
.fn {color:#38C9E8} /* function/class names */
.str{color:#3DD68C} /* strings */
.cm {color:#3a5a7a;font-style:italic} /* comments */
.ty {color:#FFAB4A} /* types */
.nm {color:#F472B6} /* property names */

/* â”€â”€ MODULE TREE â”€â”€ */
.tree{
  background:rgba(5,14,26,.95);border:1px solid rgba(56,201,232,.2);
  border-radius:14px;padding:28px 32px;font-family:'JetBrains Mono',monospace;
  font-size:12px;line-height:2;overflow-x:auto;
}
.t-root{color:var(--cyan);font-weight:700;font-size:14px}
.t-bl{color:var(--purple);font-weight:600}
.t-app{color:var(--orange)}
.t-core{color:#9B72F5}
.t-feat{color:var(--blue2)}
.t-vm{color:var(--green);font-weight:600}
.t-plat{color:var(--pink)}
.t-cm{color:#2a4a6a;font-style:italic}
.t-plugin{color:var(--orange)}

/* â”€â”€ CONVENTION PLUGINS TABLE â”€â”€ */
.plugin-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:16px;margin-bottom:28px}
.plugin-card{
  background:rgba(14,35,56,.8);border:1px solid rgba(155,114,245,.25);
  border-radius:12px;padding:18px 20px;
}
.plugin-name{font-family:'JetBrains Mono',monospace;font-size:13px;font-weight:500;color:var(--purple);margin-bottom:6px}
.plugin-id{font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--muted);background:rgba(155,114,245,.1);padding:2px 8px;border-radius:4px;display:inline-block;margin-bottom:8px}
.plugin-desc{font-size:12px;color:var(--muted);line-height:1.55}
.plugin-applies{font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--cyan);margin-top:7px}

/* â”€â”€ NAV TREE â”€â”€ */
.nav-tree{display:flex;flex-direction:column;align-items:center}
.nav-node{
  background:rgba(14,35,56,.9);border:1.5px solid var(--border);
  border-radius:9px;padding:9px 16px;font-size:12px;font-weight:600;
  text-align:center;white-space:nowrap;min-width:90px;
  transition:all .18s;cursor:default;
}
.nav-node:hover{border-color:var(--blue);transform:scale(1.04);z-index:5;position:relative}
.nn-root{background:var(--blue);border-color:var(--cyan);color:#fff;font-size:14px;padding:11px 26px}
.nn-auth{border-color:rgba(255,171,74,.5);color:var(--orange)}
.nn-main{border-color:rgba(56,201,232,.5);color:var(--cyan);font-size:13px;padding:10px 20px}
.nn-tab{border-color:rgba(61,214,140,.4);color:var(--green)}
.nn-sub{border-color:var(--border);color:var(--muted);font-size:11px;padding:7px 12px}
.vline{width:1px;height:24px;background:var(--border);margin:0 auto}
.hrow{display:flex;justify-content:center;align-items:flex-start;gap:14px}
.branch{display:flex;flex-direction:column;align-items:center}

/* â”€â”€ TECH GRID â”€â”€ */
.tech-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:14px}
.tech-card{
  background:rgba(14,35,56,.7);border:1px solid var(--border);
  border-radius:11px;padding:18px;transition:all .2s;
}
.tech-card:hover{border-color:rgba(45,125,210,.55);transform:translateY(-2px)}
.tech-cat{font-size:9px;font-weight:700;letter-spacing:2px;text-transform:uppercase;margin-bottom:7px}
.tech-name{font-size:15px;font-weight:700;margin-bottom:4px}
.tech-purpose{font-size:12px;color:var(--muted);line-height:1.55}
.tech-ver{font-family:'JetBrains Mono',monospace;font-size:10px;margin-top:7px;opacity:.55}

/* â”€â”€ FOOTER â”€â”€ */
footer{
  position:relative;z-index:1;border-top:1px solid var(--border);
  padding:28px 64px;display:flex;justify-content:space-between;align-items:center;
  background:rgba(9,25,41,.6);font-size:11px;color:var(--muted);
  font-family:'JetBrains Mono',monospace;
}
@media(max-width:900px){
  header{padding:24px;flex-direction:column;gap:14px;align-items:flex-start}
  .tabs{padding:0 20px}
  .panel{padding:28px 20px}
  .g2,.g3,.g4{grid-template-columns:1fr}
  .prod-grid{grid-template-columns:1fr}
  .plugin-grid{grid-template-columns:1fr}
  footer{flex-direction:column;gap:6px;text-align:center;padding:20px}
  .mvvm-flow{flex-direction:column}
}
</style>
</head>
<body>

<header>
  <div class="logo-wrap">
    <div class="logo">E</div>
    <div>
      <h1>ESDIAC <span>Architecture</span></h1>
      <p class="tagline">// KMP Â· Compose MP Â· MVVM Â· Build-Logic Convention Plugins Â· v2.0</p>
    </div>
  </div>
  <div class="badges">
    <span class="badge bkmp">KMP 2.x</span>
    <span class="badge bcmp">Compose MP</span>
    <span class="badge bmvvm">MVVM</span>
    <span class="badge bbuild">Build-Logic</span>
  </div>
</header>

<nav class="tabs">
  <button class="tab on"  onclick="go('overview',this)">Overview</button>
  <button class="tab"     onclick="go('buildlogic',this)">Build-Logic</button>
  <button class="tab"     onclick="go('modules',this)">Module Structure</button>
  <button class="tab"     onclick="go('layers',this)">Architecture Layers</button>
  <button class="tab"     onclick="go('mvvm',this)">MVVM Pattern</button>
  <button class="tab"     onclick="go('nav',this)">Navigation</button>
  <button class="tab"     onclick="go('stack',this)">Tech Stack</button>
</nav>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• OVERVIEW â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="p-overview" class="panel on">
  <p class="sec">Product Lines</p>
  <div class="prod-grid">
    <div class="prod-col call">
      <div class="prod-head"><span class="dot" style="background:var(--cyan)"></span>Esdiac Call</div>
      <div class="prod-items">
        <div class="prod-item">International VoIP Calling</div>
        <div class="prod-item">Call History &amp; Contacts</div>
        <div class="prod-item">Custom Dialpad</div>
        <div class="prod-item">Mobile Top-Up</div>
        <div class="prod-item">Business Suite</div>
        <div class="prod-item">AI Transcription &amp; Summary</div>
        <div class="prod-item">Smart Call Routing</div>
        <div class="prod-item">Live Translation</div>
      </div>
    </div>
    <div class="prod-col data">
      <div class="prod-head"><span class="dot" style="background:var(--green)"></span>Esdiac Data</div>
      <div class="prod-items">
        <div class="prod-item">Local eSIM (100+ countries)</div>
        <div class="prod-item">Regional eSIM</div>
        <div class="prod-item">Global eSIM</div>
        <div class="prod-item">Data Top-Up</div>
        <div class="prod-item">Instant QR Provisioning</div>
      </div>
    </div>
    <div class="prod-col pay">
      <div class="prod-head"><span class="dot" style="background:var(--orange)"></span>Esdiac Pay</div>
      <div class="prod-items">
        <div class="prod-item">eGift Cards</div>
        <div class="prod-item">Global Marketplace</div>
        <div class="prod-item">Logistics Platform</div>
        <div class="prod-item">Cross-border Payments</div>
        <div class="prod-item">Diaspora Gifting</div>
      </div>
    </div>
  </div>

  <p class="sec">Architectural Pillars</p>
  <div class="g2" style="margin-bottom:36px">
    <div class="card"><div class="card-cat" style="color:var(--cyan)">Clean Architecture</div><div class="card-title">Three inward-pointing layers</div><div class="card-body">UI â†’ Presentation (MVVM) â†’ Domain â†’ Data. The domain layer is pure Kotlin with zero platform imports. Fully unit-testable in commonTest.</div></div>
    <div class="card"><div class="card-cat" style="color:var(--purple)">Build-Logic Convention Plugins</div><div class="card-title">DRY Gradle configuration</div><div class="card-body">One included build, 7 convention plugins. Each feature module's build.gradle.kts is ~10 lines. All boilerplate in one place.</div></div>
    <div class="card"><div class="card-cat" style="color:var(--green)">MVVM + StateFlow</div><div class="card-title">Predictable state management</div><div class="card-body">BaseViewModel exposes UiState via StateFlow and one-time UiEvents via SharedFlow. KMP lifecycle-viewmodel survives config changes on both platforms.</div></div>
    <div class="card"><div class="card-cat" style="color:var(--orange)">Feature-First Modules</div><div class="card-title">Independent, scalable modules</div><div class="card-body">Each product line is an independent Gradle module. Adding a new feature = one new folder + one settings include. Zero changes to existing code.</div></div>
  </div>

  <p class="sec">Feature Modules</p>
  <div class="g3">
    <div class="card" style="border-color:rgba(255,171,74,.3)"><div class="card-cat" style="color:var(--orange)">:feature:auth</div><div class="card-title" style="font-size:14px">Authentication</div><div class="card-body">Splash â†’ GetStarted â†’ Login â†’ OTP â†’ Register</div></div>
    <div class="card" style="border-color:rgba(56,201,232,.3)"><div class="card-cat" style="color:var(--cyan)">:feature:home</div><div class="card-title" style="font-size:14px">Home Dashboard</div><div class="card-body">Transactions Â· Notifications Â· Promotions</div></div>
    <div class="card" style="border-color:rgba(56,201,232,.3)"><div class="card-cat" style="color:var(--cyan)">:feature:call</div><div class="card-title" style="font-size:14px">VoIP Calling</div><div class="card-body">History Â· Contacts Â· Dialpad Â· Active call</div></div>
    <div class="card" style="border-color:rgba(61,214,140,.3)"><div class="card-cat" style="color:var(--green)">:feature:data-esim</div><div class="card-title" style="font-size:14px">eSIM Data</div><div class="card-body">Local Â· Regional Â· Global plans + purchase</div></div>
    <div class="card" style="border-color:rgba(61,214,140,.3)"><div class="card-cat" style="color:var(--green)">:feature:topup</div><div class="card-title" style="font-size:14px">Top-Up</div><div class="card-body">Mobile + Data top-up: country â†’ carrier â†’ buy</div></div>
    <div class="card" style="border-color:rgba(255,171,74,.3)"><div class="card-cat" style="color:var(--orange)">:feature:pay</div><div class="card-title" style="font-size:14px">Esdiac Pay</div><div class="card-body">eGift â†’ country â†’ category â†’ brands â†’ buy</div></div>
  </div>
</section>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• BUILD-LOGIC â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="p-buildlogic" class="panel">
  <p class="sec">Convention Plugins</p>
  <div class="plugin-grid">
    <div class="plugin-card">
      <div class="plugin-name">EsdiacAndroidApplicationPlugin</div>
      <div class="plugin-id">esdiac.android.application</div>
      <div class="plugin-desc">Sets compileSdk, minSdk, applicationId, signing configs, ProGuard rules, and Java 17 target for the androidApp module.</div>
      <div class="plugin-applies">Applies â†’ android.application + kotlin.android</div>
    </div>
    <div class="plugin-card">
      <div class="plugin-name">EsdiacKmpLibraryPlugin</div>
      <div class="plugin-id">esdiac.kmp.library</div>
      <div class="plugin-desc">Configures KMP targets (androidTarget, iosX64, iosArm64, iosSimulatorArm64), jvmTarget = 17, framework baseName, and base coroutine dependencies.</div>
      <div class="plugin-applies">Applies â†’ kotlin.multiplatform + android.library</div>
    </div>
    <div class="plugin-card">
      <div class="plugin-name">EsdiacKmpComposePlugin</div>
      <div class="plugin-id">esdiac.kmp.compose</div>
      <div class="plugin-desc">Adds Compose MP and compose.compiler plugins. Injects compose.ui, compose.material3, compose.resources, and uiToolingPreview into commonMain.</div>
      <div class="plugin-applies">Applies â†’ org.jetbrains.compose + kotlin.plugin.compose</div>
    </div>
    <div class="plugin-card" style="border-color:rgba(61,214,140,.3)">
      <div class="plugin-name" style="color:var(--green)">EsdiacKmpFeaturePlugin â­</div>
      <div class="plugin-id" style="background:rgba(61,214,140,.1);color:var(--green)">esdiac.kmp.feature</div>
      <div class="plugin-desc">The key composite plugin. Applied to every feature module. Pulls in MVVM (lifecycle-viewmodel), Decompose navigation, Koin DI, and all core modules automatically.</div>
      <div class="plugin-applies">Applies â†’ esdiac.kmp.library + esdiac.kmp.compose</div>
    </div>
    <div class="plugin-card">
      <div class="plugin-name">EsdiacAndroidLibraryPlugin</div>
      <div class="plugin-id">esdiac.android.library</div>
      <div class="plugin-desc">Used for pure Android modules that don't need KMP (e.g., Android-only platform integrations). Sets compileSdk, namespace, and ViewBinding.</div>
      <div class="plugin-applies">Applies â†’ android.library + kotlin.android</div>
    </div>
    <div class="plugin-card">
      <div class="plugin-name">EsdiacDetektPlugin</div>
      <div class="plugin-id">esdiac.detekt</div>
      <div class="plugin-desc">Applies Detekt static analysis with a shared detekt.yml baseline. Configures the Detekt task to run on all KMP source sets and hooks into the check task.</div>
      <div class="plugin-applies">Applies â†’ io.gitlab.arturbosch.detekt</div>
    </div>
  </div>

  <p class="sec">build-logic Folder Structure</p>
  <div class="tree">
<span class="t-root">build-logic/</span>
  â”œâ”€â”€ <span class="t-bl">settings.gradle.kts</span>
  â”‚     <span class="t-cm">// dependencyResolutionManagement { repositories { google(); mavenCentral() } }</span>
  â”‚     <span class="t-cm">// rootProject.name = "build-logic"</span>
  â”œâ”€â”€ <span class="t-bl">build.gradle.kts</span>
  â”‚     <span class="t-cm">// empty â€” convention/ is the only subproject</span>
  â””â”€â”€ <span class="t-bl">convention/</span>
        â”œâ”€â”€ <span class="t-bl">build.gradle.kts</span>
        â”‚     <span class="t-cm">// dependencies { compileOnly(libs.agp); compileOnly(libs.kotlin.gradle) }</span>
        â”‚     <span class="t-cm">// gradlePlugin { plugins { register("esdiac.kmp.feature") { ... } } }</span>
        â””â”€â”€ src/main/kotlin/
              â”œâ”€â”€ <span class="t-plugin">EsdiacAndroidApplicationPlugin.kt</span>
              â”œâ”€â”€ <span class="t-plugin">EsdiacAndroidLibraryPlugin.kt</span>
              â”œâ”€â”€ <span class="t-plugin">EsdiacKmpLibraryPlugin.kt</span>   <span class="t-cm">â† KMP targets + Android config</span>
              â”œâ”€â”€ <span class="t-plugin">EsdiacKmpComposePlugin.kt</span>    <span class="t-cm">â† Compose MP + compiler</span>
              â”œâ”€â”€ <span class="t-plugin">EsdiacKmpFeaturePlugin.kt</span>    <span class="t-cm">â† Composite: kmp + compose + viewmodel + koin + decompose â­</span>
              â”œâ”€â”€ <span class="t-plugin">EsdiacAndroidFeaturePlugin.kt</span>
              â””â”€â”€ <span class="t-plugin">EsdiacDetektPlugin.kt</span>
  </div>

  <p class="sec">Version Catalog â€” gradle/libs.versions.toml (key entries)</p>
  <div class="code">
<span class="cm">[versions]</span>
<span class="nm">kotlin</span>                 = <span class="str">"2.1.0"</span>
<span class="nm">compose-multiplatform</span>  = <span class="str">"1.7.0"</span>
<span class="nm">lifecycle-viewmodel</span>    = <span class="str">"2.9.0"</span>     <span class="cm"># KMP ViewModel â€” org.jetbrains.androidx.lifecycle</span>
<span class="nm">decompose</span>              = <span class="str">"3.1.0"</span>
<span class="nm">koin</span>                   = <span class="str">"4.0.0"</span>
<span class="nm">ktor</span>                   = <span class="str">"3.0.0"</span>
<span class="nm">sqldelight</span>             = <span class="str">"2.0.2"</span>
<span class="nm">coroutines</span>             = <span class="str">"1.9.0"</span>
<span class="nm">serialization</span>          = <span class="str">"1.7.3"</span>
<span class="nm">coil</span>                   = <span class="str">"3.0.4"</span>
<span class="nm">detekt</span>                 = <span class="str">"1.23.7"</span>

<span class="cm">[libraries]</span>
<span class="nm">lifecycle-viewmodel</span>           = <span class="str">{ module = "org.jetbrains.androidx.lifecycle:lifecycle-viewmodel",        version.ref = "lifecycle-viewmodel" }</span>
<span class="nm">lifecycle-viewmodel-compose</span>   = <span class="str">{ module = "org.jetbrains.androidx.lifecycle:lifecycle-viewmodel-compose", version.ref = "lifecycle-viewmodel" }</span>
<span class="nm">decompose</span>                     = <span class="str">{ module = "com.arkivanov.decompose:decompose",                           version.ref = "decompose" }</span>
<span class="nm">decompose-extensions-compose</span>  = <span class="str">{ module = "com.arkivanov.decompose:extensions-compose",                 version.ref = "decompose" }</span>
<span class="nm">koin-core</span>                     = <span class="str">{ module = "io.insert-koin:koin-core",                                   version.ref = "koin" }</span>
<span class="nm">koin-compose</span>                  = <span class="str">{ module = "io.insert-koin:koin-compose",                                version.ref = "koin" }</span>

<span class="cm">[plugins]</span>
<span class="nm">esdiac-kmp-feature</span>     = <span class="str">{ id = "esdiac.kmp.feature" }</span>     <span class="cm"># â† used in every feature module</span>
<span class="nm">esdiac-kmp-library</span>     = <span class="str">{ id = "esdiac.kmp.library" }</span>
<span class="nm">esdiac-kmp-compose</span>     = <span class="str">{ id = "esdiac.kmp.compose" }</span>
<span class="nm">esdiac-android-app</span>     = <span class="str">{ id = "esdiac.android.application" }</span>
<span class="nm">esdiac-detekt</span>          = <span class="str">{ id = "esdiac.detekt" }</span>
  </div>

  <p class="sec">A Feature Module build.gradle.kts  â€” before vs after</p>
  <div class="g2">
    <div>
      <p style="font-size:12px;color:var(--red);margin-bottom:10px;font-family:'JetBrains Mono',monospace">âœ— Without convention plugins (~60 lines)</p>
      <div class="code" style="border-color:rgba(248,113,113,.25)">
<span class="cm">// :feature:data-esim/build.gradle.kts</span>
<span class="kw">plugins</span> {
  id(<span class="str">"org.jetbrains.kotlin.multiplatform"</span>)
  id(<span class="str">"com.android.library"</span>)
  id(<span class="str">"org.jetbrains.compose"</span>)
  id(<span class="str">"org.jetbrains.kotlin.plugin.compose"</span>)
  id(<span class="str">"org.jetbrains.kotlin.plugin.serialization"</span>)
}
<span class="kw">kotlin</span> {
  androidTarget { compilations.all {
    kotlinOptions { jvmTarget = <span class="str">"17"</span> } } }
  listOf(iosX64(), iosArm64(),
    iosSimulatorArm64()).forEach {
      it.binaries.framework { baseName = <span class="str">"data-esim"</span> }
  }
  sourceSets {
    commonMain.dependencies {
      implementation(compose.ui)
      implementation(compose.material3)
      implementation(<span class="str">"io.insert-koin:koin-core:4.0.0"</span>)
      implementation(<span class="str">"io.insert-koin:koin-compose:4.0.0"</span>)
      implementation(<span class="str">"com.arkivanov.decompose:decompose:3.1.0"</span>)
      implementation(<span class="str">"org.jetbrains.androidx.lifecycle:lifecycle-viewmodel:2.9.0"</span>)
      <span class="cm">// ... 10 more lines</span>
    }
  }
}
android {
  compileSdk = <span class="ty">35</span>
  namespace = <span class="str">"com.esdiac.esim"</span>
  defaultConfig { minSdk = <span class="ty">24</span> }
  compileOptions { sourceCompatibility = <span class="ty">VERSION_17</span> ... }
}
      </div>
    </div>
    <div>
      <p style="font-size:12px;color:var(--green);margin-bottom:10px;font-family:'JetBrains Mono',monospace">âœ“ With convention plugins (~8 lines)</p>
      <div class="code" style="border-color:rgba(61,214,140,.3)">
<span class="cm">// :feature:data-esim/build.gradle.kts</span>
<span class="kw">plugins</span> {
  alias(libs.plugins.<span class="fn">esdiac.kmp.feature</span>)   <span class="cm">// â† does everything</span>
  alias(libs.plugins.<span class="fn">kotlin.serialization</span>) <span class="cm">// for DTO @Serializable</span>
  alias(libs.plugins.<span class="fn">esdiac.detekt</span>)        <span class="cm">// static analysis</span>
}
<span class="kw">kotlin</span> {
  sourceSets {
    commonMain.dependencies {
      <span class="cm">// only feature-specific additions:</span>
      implementation(project(<span class="str">":shared:core:core-network"</span>))
      implementation(project(<span class="str">":shared:core:core-database"</span>))
    }
  }
}
      </div>
    </div>
  </div>
</section>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MODULES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="p-modules" class="panel">
  <p class="sec">Full Gradle Module Tree</p>
  <div class="tree">
<span class="t-root">esdiac/</span>
  â”œâ”€â”€ <span class="t-bl">build-logic/</span>                  <span class="t-cm">â† Included build â€” convention plugins</span>
  â”œâ”€â”€ gradle/libs.versions.toml     <span class="t-cm">â† Single version catalog</span>
  â”œâ”€â”€ settings.gradle.kts           <span class="t-cm">â† includeBuild("build-logic") + all modules</span>
  â”œâ”€â”€ <span class="t-app">androidApp/</span>                   <span class="t-cm">â† Android entry point</span>
  â”‚     build.gradle.kts            <span class="t-plugin">plugins { alias(libs.plugins.esdiac.android.app) }</span>
  â”‚     â””â”€â”€ src/main/
  â”‚           â”œâ”€â”€ MainActivity.kt   <span class="t-cm">setContent { ComposeApp() }</span>
  â”‚           â””â”€â”€ EsdiacApplication.kt  <span class="t-cm">initKoin { androidContext(...) }</span>
  â”œâ”€â”€ <span class="t-app">iosApp/</span>                       <span class="t-cm">â† Xcode project</span>
  â”‚     â””â”€â”€ iosApp/ { iOSApp.swift, ContentView.swift }
  â””â”€â”€ <span class="t-core">shared/</span>
        â”œâ”€â”€ <span class="t-core">core/</span>
        â”‚     â”œâ”€â”€ <span class="t-core">core-ui/</span>              <span class="t-plugin">â†’ esdiac.kmp.library + esdiac.kmp.compose</span>
        â”‚     â”‚     â”œâ”€â”€ theme/          <span class="t-cm">(EsdiacTheme, LightColors, DarkColors, Typography, Shapes)</span>
        â”‚     â”‚     â”œâ”€â”€ components/     <span class="t-cm">(EsdiacButton, EsdiacCard, EsdiacTopBar, EsdiacBottomNavâ€¦)</span>
        â”‚     â”‚     â””â”€â”€ icons/
        â”‚     â”œâ”€â”€ <span class="t-core">core-network/</span>         <span class="t-plugin">â†’ esdiac.kmp.library + kotlin.serialization</span>
        â”‚     â”‚     â”œâ”€â”€ HttpClientFactory.kt
        â”‚     â”‚     â”œâ”€â”€ interceptors/
        â”‚     â”‚     â””â”€â”€ ApiResponse.kt  <span class="t-cm">(sealed: Loading | Success&lt;T&gt; | Error)</span>
        â”‚     â”œâ”€â”€ <span class="t-core">core-database/</span>        <span class="t-plugin">â†’ esdiac.kmp.library + sqldelight</span>
        â”‚     â”‚     â”œâ”€â”€ EsdiacDatabase.sq
        â”‚     â”‚     â””â”€â”€ DatabaseDriverFactory.kt  <span class="t-cm">(expect/actual)</span>
        â”‚     â”œâ”€â”€ <span class="t-core">core-domain/</span>          <span class="t-plugin">â†’ esdiac.kmp.library</span>
        â”‚     â”‚     â”œâ”€â”€ <span class="t-vm">BaseViewModel.kt</span>    <span class="t-cm">(StateFlow UiState + SharedFlow UiEvent)</span>
        â”‚     â”‚     â”œâ”€â”€ UseCase.kt
        â”‚     â”‚     â”œâ”€â”€ FlowUseCase.kt
        â”‚     â”‚     â”œâ”€â”€ Resource.kt     <span class="t-cm">(Loading | Success&lt;T&gt; | Error)</span>
        â”‚     â”‚     â”œâ”€â”€ UiState.kt      <span class="t-cm">(marker interface)</span>
        â”‚     â”‚     â””â”€â”€ UiEvent.kt      <span class="t-cm">(marker interface)</span>
        â”‚     â”œâ”€â”€ <span class="t-core">core-navigation/</span>      <span class="t-plugin">â†’ esdiac.kmp.library</span>
        â”‚     â”‚     â”œâ”€â”€ RootComponent.kt
        â”‚     â”‚     â””â”€â”€ AppNavConfig.kt <span class="t-cm">(sealed: Auth | Main)</span>
        â”‚     â””â”€â”€ <span class="t-core">core-di/</span>              <span class="t-plugin">â†’ esdiac.kmp.library</span>
        â”‚           â””â”€â”€ AppModule.kt    <span class="t-cm">(initKoin â€” aggregates all feature modules)</span>
        â””â”€â”€ <span class="t-feat">feature/</span>
              â”œâ”€â”€ <span class="t-feat">auth/</span>                  <span class="t-plugin">â†’ esdiac.kmp.feature</span>
              â”‚     â”œâ”€â”€ domain/ { User, OtpCode, AuthToken, AuthRepository, LoginUseCase, OtpUseCase, RegisterUseCase }
              â”‚     â”œâ”€â”€ data/   { AuthApiService, AuthDto, AuthMapper, AuthRepositoryImpl }
              â”‚     â””â”€â”€ presentation/
              â”‚           â”œâ”€â”€ AuthComponent.kt
              â”‚           â”œâ”€â”€ splash/     { <span class="t-vm">SplashViewModel</span> + SplashScreen }
              â”‚           â”œâ”€â”€ getstarted/ { GetStartedScreen }
              â”‚           â”œâ”€â”€ login/      { <span class="t-vm">LoginViewModel</span> + LoginScreen }
              â”‚           â”œâ”€â”€ otp/        { <span class="t-vm">OtpViewModel</span> + OtpScreen }
              â”‚           â””â”€â”€ register/   { <span class="t-vm">RegisterViewModel</span> + RegisterScreen }
              â”œâ”€â”€ <span class="t-feat">home/</span>                  <span class="t-plugin">â†’ esdiac.kmp.feature</span>
              â”‚     â”œâ”€â”€ domain/ { Transaction, Notification, Promo, GetTransactionsUseCase }
              â”‚     â”œâ”€â”€ data/
              â”‚     â””â”€â”€ presentation/
              â”‚           â”œâ”€â”€ HomeComponent.kt
              â”‚           â””â”€â”€ home/ { <span class="t-vm">HomeViewModel</span> + HomeScreen }
              â”œâ”€â”€ <span class="t-feat">call/</span>                  <span class="t-plugin">â†’ esdiac.kmp.feature</span>
              â”‚     â”œâ”€â”€ domain/ { CallRecord, Contact, VoipEngine(expect/actual), InitCallUseCase }
              â”‚     â”œâ”€â”€ data/
              â”‚     â””â”€â”€ presentation/
              â”‚           â”œâ”€â”€ CallComponent.kt
              â”‚           â”œâ”€â”€ history/    { <span class="t-vm">CallHistoryViewModel</span> + CallHistoryScreen }
              â”‚           â”œâ”€â”€ contacts/   { <span class="t-vm">ContactsViewModel</span> + ContactsScreen }
              â”‚           â”œâ”€â”€ dialpad/    { <span class="t-vm">DialpadViewModel</span> + DialpadScreen }
              â”‚           â””â”€â”€ activecall/ { <span class="t-vm">ActiveCallViewModel</span> + ActiveCallScreen }
              â”œâ”€â”€ <span class="t-feat">data-esim/</span>             <span class="t-plugin">â†’ esdiac.kmp.feature + kotlin.serialization</span>
              â”‚     â”œâ”€â”€ domain/ { EsimPlan, Country, Region, EsimRepository, GetOffersUseCase }
              â”‚     â”œâ”€â”€ data/
              â”‚     â””â”€â”€ presentation/
              â”‚           â”œâ”€â”€ EsimComponent.kt  <span class="t-cm">(tabs: LOCAL | REGIONAL | GLOBAL)</span>
              â”‚           â”œâ”€â”€ local/    { <span class="t-vm">EsimLocalViewModel</span> + EsimLocalScreen }
              â”‚           â”œâ”€â”€ regional/ { <span class="t-vm">EsimRegionalViewModel</span> + EsimRegionalScreen }
              â”‚           â”œâ”€â”€ global/   { <span class="t-vm">EsimGlobalViewModel</span> + EsimGlobalScreen }
              â”‚           â””â”€â”€ detail/   { <span class="t-vm">EsimDetailViewModel</span> + EsimDetailScreen }
              â”œâ”€â”€ <span class="t-feat">topup/</span>                 <span class="t-plugin">â†’ esdiac.kmp.feature</span>
              â”‚     â”œâ”€â”€ domain/ { TopupOffer, Carrier, MobileTopupUseCase, DataTopupUseCase }
              â”‚     â”œâ”€â”€ data/
              â”‚     â””â”€â”€ presentation/  <span class="t-cm">(TopupType.MOBILE | DATA â€” shared UI, different endpoints)</span>
              â”‚           â”œâ”€â”€ TopupComponent.kt
              â”‚           â”œâ”€â”€ country/ { <span class="t-vm">CountryListViewModel</span> + CountryListScreen }
              â”‚           â”œâ”€â”€ carrier/ { <span class="t-vm">CarrierListViewModel</span> + CarrierListScreen }
              â”‚           â””â”€â”€ detail/  { <span class="t-vm">TopupDetailViewModel</span> + TopupDetailScreen }
              â”œâ”€â”€ <span class="t-feat">pay/</span>                   <span class="t-plugin">â†’ esdiac.kmp.feature</span>
              â”‚     â”œâ”€â”€ domain/ { GiftCard, Brand, Category, GiftCardUseCase }
              â”‚     â”œâ”€â”€ data/
              â”‚     â””â”€â”€ presentation/
              â”‚           â”œâ”€â”€ PayComponent.kt
              â”‚           â””â”€â”€ egift/
              â”‚                 â”œâ”€â”€ country/  { <span class="t-vm">EgiftCountryViewModel</span> + Screen }
              â”‚                 â”œâ”€â”€ category/ { <span class="t-vm">EgiftCategoryViewModel</span> + Screen }
              â”‚                 â”œâ”€â”€ brands/   { <span class="t-vm">EgiftBrandsViewModel</span> + Screen }
              â”‚                 â”œâ”€â”€ offers/   { <span class="t-vm">EgiftOffersViewModel</span> + Screen }
              â”‚                 â””â”€â”€ detail/   { <span class="t-vm">EgiftDetailViewModel</span> + Screen }
              â””â”€â”€ <span class="t-feat">profile/</span>               <span class="t-plugin">â†’ esdiac.kmp.feature</span>
                    â””â”€â”€ presentation/ { <span class="t-vm">ProfileViewModel</span> + ProfileScreen }

  <span class="t-plat">// expect/actual in shared/androidMain + iosMain:</span>
  <span class="t-plat">// VoipEngineActual.kt  DatabaseDriverActual.kt  PushHandlerActual.kt  ContactsProviderActual.kt</span>
  </div>
</section>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LAYERS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="p-layers" class="panel">
  <p class="sec">Clean Architecture Stack â€” per feature module</p>
  <div class="layers">
    <div class="layer l-ui">
      <div class="layer-left"><span class="layer-icon">ğŸ–¼ï¸</span><div><div class="layer-name">UI Layer â€” Compose Multiplatform</div><div class="layer-sub">@Composable screens Â· collectAsStateWithLifecycle() Â· LaunchedEffect(events)</div></div></div>
      <div class="layer-tags"><span class="tag tag-ui">Compose MP</span><span class="tag tag-ui">Material 3</span><span class="tag tag-ui">Coil 3</span><span class="tag tag-ui">EsdiacTheme</span></div>
    </div>
    <div class="arrow-dn">â†“ collectAsStateWithLifecycle Â· viewModel.action()</div>
    <div class="layer l-pres">
      <div class="layer-left"><span class="layer-icon">âš™ï¸</span><div><div class="layer-name">Presentation Layer â€” MVVM ViewModel</div><div class="layer-sub">UiState: StateFlow Â· UiEvent: SharedFlow Â· viewModelScope coroutines</div></div></div>
      <div class="layer-tags"><span class="tag tag-pres">lifecycle-viewmodel KMP</span><span class="tag tag-pres">Decompose</span><span class="tag tag-pres">Koin viewModel()</span></div>
    </div>
    <div class="arrow-dn">â†“ calls UseCase.invoke()</div>
    <div class="layer l-domain">
      <div class="layer-left"><span class="layer-icon">ğŸ’</span><div><div class="layer-name">Domain Layer â€” Pure Kotlin</div><div class="layer-sub">Entities Â· Repository interfaces Â· Use cases â€” zero platform imports</div></div></div>
      <div class="layer-tags"><span class="tag tag-domain">Pure Kotlin</span><span class="tag tag-domain">commonMain only</span><span class="tag tag-domain">Unit testable</span></div>
    </div>
    <div class="arrow-dn">â†“ implements Repository interface</div>
    <div class="layer l-data">
      <div class="layer-left"><span class="layer-icon">ğŸ—„ï¸</span><div><div class="layer-name">Data Layer â€” Repository Implementations</div><div class="layer-sub">Ktor remote Â· SQLDelight local Â· DTOâ†”Domain mappers Â· cache strategy</div></div></div>
      <div class="layer-tags"><span class="tag tag-data">Ktor 3</span><span class="tag tag-data">SQLDelight 2</span><span class="tag tag-data">Mappers</span><span class="tag tag-data">Cache-first</span></div>
    </div>
  </div>

  <p class="sec">Feature Architecture Summary</p>
  <div style="overflow-x:auto">
  <table style="width:100%;border-collapse:collapse;font-size:13px">
    <thead><tr style="background:rgba(45,125,210,.2)">
      <th style="padding:12px 16px;text-align:left;color:var(--cyan);border-bottom:1px solid var(--border)">Module</th>
      <th style="padding:12px 16px;text-align:left;color:var(--cyan);border-bottom:1px solid var(--border)">Convention Plugin</th>
      <th style="padding:12px 16px;text-align:left;color:var(--cyan);border-bottom:1px solid var(--border)">ViewModels</th>
      <th style="padding:12px 16px;text-align:left;color:var(--cyan);border-bottom:1px solid var(--border)">Key Use Cases</th>
    </tr></thead>
    <tbody>
      <tr style="border-bottom:1px solid rgba(56,201,232,.08)"><td style="padding:12px 16px;font-weight:700">:feature:auth</td><td style="padding:12px 16px;font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--purple)">esdiac.kmp.feature</td><td style="padding:12px 16px;color:var(--muted)">Splash, Login, Otp, Register</td><td style="padding:12px 16px;color:var(--muted)">LoginUseCase, OtpVerifyUseCase, RegisterUseCase</td></tr>
      <tr style="border-bottom:1px solid rgba(56,201,232,.08);background:rgba(56,201,232,.02)"><td style="padding:12px 16px;font-weight:700">:feature:home</td><td style="padding:12px 16px;font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--purple)">esdiac.kmp.feature</td><td style="padding:12px 16px;color:var(--muted)">HomeViewModel</td><td style="padding:12px 16px;color:var(--muted)">GetTransactionsUseCase, GetNotificationsUseCase</td></tr>
      <tr style="border-bottom:1px solid rgba(56,201,232,.08)"><td style="padding:12px 16px;font-weight:700">:feature:call</td><td style="padding:12px 16px;font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--purple)">esdiac.kmp.feature</td><td style="padding:12px 16px;color:var(--muted)">CallHistory, Contacts, Dialpad, ActiveCall</td><td style="padding:12px 16px;color:var(--muted)">InitCallUseCase, GetHistoryUseCase, VoipEngine(expect)</td></tr>
      <tr style="border-bottom:1px solid rgba(56,201,232,.08);background:rgba(56,201,232,.02)"><td style="padding:12px 16px;font-weight:700">:feature:data-esim</td><td style="padding:12px 16px;font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--purple)">esdiac.kmp.feature + serialization</td><td style="padding:12px 16px;color:var(--muted)">EsimLocal, EsimRegional, EsimGlobal, EsimDetail</td><td style="padding:12px 16px;color:var(--muted)">GetCountriesUseCase, GetEsimOffersUseCase, PurchaseEsimUseCase</td></tr>
      <tr style="border-bottom:1px solid rgba(56,201,232,.08)"><td style="padding:12px 16px;font-weight:700">:feature:topup</td><td style="padding:12px 16px;font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--purple)">esdiac.kmp.feature</td><td style="padding:12px 16px;color:var(--muted)">CountryList, CarrierList, TopupDetail</td><td style="padding:12px 16px;color:var(--muted)">MobileTopupUseCase, DataTopupUseCase</td></tr>
      <tr style="background:rgba(56,201,232,.02)"><td style="padding:12px 16px;font-weight:700">:feature:pay</td><td style="padding:12px 16px;font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--purple)">esdiac.kmp.feature</td><td style="padding:12px 16px;color:var(--muted)">EgiftCountry, Category, Brands, Offers, Detail</td><td style="padding:12px 16px;color:var(--muted)">GetBrandsUseCase, GetGiftCardsUseCase, PurchaseGiftCardUseCase</td></tr>
    </tbody>
  </table>
  </div>
</section>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MVVM â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="p-mvvm" class="panel">
  <p class="sec">Model â€” View â€” ViewModel</p>

  <div class="mvvm-flow">
    <div class="mvvm-node" style="border-color:rgba(56,201,232,.5)">
      <div class="mvvm-icon">ğŸ–¥ï¸</div>
      <div class="mvvm-title" style="color:var(--cyan)">View (Composable)</div>
      <div class="mvvm-items">@Composable fun Screen()<br>collectAsStateWithLifecycle<br>LaunchedEffect(vm.uiEvent)<br>vm.onAction() calls</div>
    </div>
    <div class="mvvm-arrow"><span>â‡„</span><small>StateFlow<br>+ actions</small></div>
    <div class="mvvm-node" style="border-color:rgba(155,114,245,.5)">
      <div class="mvvm-icon">âš™ï¸</div>
      <div class="mvvm-title" style="color:var(--purple)">ViewModel</div>
      <div class="mvvm-items">BaseViewModel&lt;S,E&gt;<br>_uiState: StateFlow&lt;S&gt;<br>_uiEvent: SharedFlow&lt;E&gt;<br>viewModelScope</div>
    </div>
    <div class="mvvm-arrow"><span>â†’</span><small>suspend<br>invoke()</small></div>
    <div class="mvvm-node" style="border-color:rgba(61,214,140,.5)">
      <div class="mvvm-icon">ğŸ’</div>
      <div class="mvvm-title" style="color:var(--green)">UseCase (Domain)</div>
      <div class="mvvm-items">operator fun invoke()<br>Flow&lt;Resource&lt;T&gt;&gt;<br>Pure Kotlin<br>No platform imports</div>
    </div>
    <div class="mvvm-arrow"><span>â†’</span><small>implements<br>interface</small></div>
    <div class="mvvm-node" style="border-color:rgba(255,171,74,.5)">
      <div class="mvvm-icon">ğŸ—„ï¸</div>
      <div class="mvvm-title" style="color:var(--orange)">Repository (Data)</div>
      <div class="mvvm-items">Ktor API call<br>SQLDelight cache<br>DTOâ†’Domain map<br>Resource wrapper</div>
    </div>
  </div>

  <p class="sec">BaseViewModel â€” shared in core-domain</p>
  <div class="code">
<span class="cm">// :core:core-domain/BaseViewModel.kt  â€” lives in commonMain, 100% shared</span>
<span class="kw">abstract class</span> <span class="fn">BaseViewModel</span>&lt;<span class="ty">S</span> : <span class="ty">UiState</span>, <span class="ty">E</span> : <span class="ty">UiEvent</span>&gt;() : <span class="ty">ViewModel</span>() {

    <span class="kw">private val</span> <span class="nm">_uiState</span> = <span class="fn">MutableStateFlow</span>(<span class="fn">initialState</span>())
    <span class="kw">val</span> <span class="nm">uiState</span>: <span class="ty">StateFlow</span>&lt;<span class="ty">S</span>&gt; = _uiState.asStateFlow()

    <span class="kw">private val</span> <span class="nm">_uiEvent</span> = <span class="fn">MutableSharedFlow</span>&lt;<span class="ty">E</span>&gt;(extraBufferCapacity = <span class="ty">1</span>)
    <span class="kw">val</span> <span class="nm">uiEvent</span>: <span class="ty">SharedFlow</span>&lt;<span class="ty">E</span>&gt; = _uiEvent.asSharedFlow()

    <span class="kw">abstract fun</span> <span class="fn">initialState</span>(): <span class="ty">S</span>

    <span class="kw">protected fun</span> <span class="fn">updateState</span>(reducer: <span class="ty">S</span>.() -> <span class="ty">S</span>) { _uiState.update { it.reducer() } }
    <span class="kw">protected fun</span> <span class="fn">emitEvent</span>(event: <span class="ty">E</span>) { viewModelScope.launch { _uiEvent.emit(event) } }
}
  </div>

  <p class="sec">Concrete Example â€” eSIM Offer List</p>
  <div class="g3">
    <div class="card" style="border-color:rgba(56,201,232,.3)">
      <div class="card-cat" style="color:var(--cyan)">UiState</div>
      <div class="code" style="margin-bottom:0;padding:14px 16px;font-size:11px">
<span class="kw">data class</span> <span class="fn">EsimOfferUiState</span>(
  <span class="kw">val</span> <span class="nm">isLoading</span>: <span class="ty">Boolean</span> = <span class="ty">true</span>,
  <span class="kw">val</span> <span class="nm">offers</span>: <span class="ty">List</span>&lt;<span class="ty">EsimOffer</span>&gt; = emptyList(),
  <span class="kw">val</span> <span class="nm">selectedCountry</span>: <span class="ty">String</span> = <span class="str">""</span>,
  <span class="kw">val</span> <span class="nm">error</span>: <span class="ty">String?</span> = <span class="kw">null</span>,
) : <span class="ty">UiState</span></div>
    </div>
    <div class="card" style="border-color:rgba(155,114,245,.3)">
      <div class="card-cat" style="color:var(--purple)">UiEvent (one-time)</div>
      <div class="code" style="margin-bottom:0;padding:14px 16px;font-size:11px">
<span class="kw">sealed class</span> <span class="fn">EsimOfferUiEvent</span> : <span class="ty">UiEvent</span> {
  <span class="kw">data class</span> <span class="fn">NavigateToDetail</span>(
    <span class="kw">val</span> <span class="nm">offerId</span>: <span class="ty">String</span>
  ) : <span class="fn">EsimOfferUiEvent</span>()
  <span class="kw">data object</span> <span class="fn">ShowNetworkError</span>
    : <span class="fn">EsimOfferUiEvent</span>()
  <span class="kw">data object</span> <span class="fn">PurchaseSuccess</span>
    : <span class="fn">EsimOfferUiEvent</span>()
}</div>
    </div>
    <div class="card" style="border-color:rgba(61,214,140,.3)">
      <div class="card-cat" style="color:var(--green)">ViewModel</div>
      <div class="code" style="margin-bottom:0;padding:14px 16px;font-size:11px">
<span class="kw">class</span> <span class="fn">EsimOfferViewModel</span>(
  <span class="kw">private val</span> <span class="nm">getOffers</span>: <span class="ty">GetEsimOffersUseCase</span>
) : <span class="fn">BaseViewModel</span>&lt;<span class="ty">EsimOfferUiState</span>,
        <span class="ty">EsimOfferUiEvent</span>&gt;() {

  <span class="kw">override fun</span> <span class="fn">initialState</span>() =
    <span class="fn">EsimOfferUiState</span>()

  <span class="kw">fun</span> <span class="fn">loadOffers</span>(country: <span class="ty">String</span>) {
    viewModelScope.launch {
      <span class="fn">getOffers</span>(country).collect {
        <span class="kw">when</span> (it) { ... }
      }
    }
  }
}</div>
    </div>
  </div>

  <p class="sec" style="margin-top:28px">Composable Screen â€” state collection</p>
  <div class="code">
<span class="kw">@Composable</span>
<span class="kw">fun</span> <span class="fn">EsimOfferScreen</span>(
    <span class="nm">viewModel</span>: <span class="ty">EsimOfferViewModel</span> = <span class="fn">koinViewModel</span>(),  <span class="cm">// injected by Koin</span>
    <span class="nm">onNavigateToDetail</span>: (<span class="ty">String</span>) -> <span class="ty">Unit</span>,
) {
    <span class="kw">val</span> <span class="nm">uiState</span> <span class="kw">by</span> viewModel.uiState.<span class="fn">collectAsStateWithLifecycle</span>()

    <span class="cm">// Collect one-time events without blocking the UI</span>
    <span class="fn">LaunchedEffect</span>(viewModel) {
        viewModel.uiEvent.<span class="fn">collect</span> { event ->
            <span class="kw">when</span> (event) {
                <span class="kw">is</span> <span class="ty">EsimOfferUiEvent.NavigateToDetail</span> -> <span class="fn">onNavigateToDetail</span>(event.offerId)
                <span class="ty">EsimOfferUiEvent.ShowNetworkError</span>    -> { <span class="cm">/* show snackbar */</span> }
                <span class="ty">EsimOfferUiEvent.PurchaseSuccess</span>     -> { <span class="cm">/* show success dialog */</span> }
            }
        }
    }

    <span class="kw">if</span> (uiState.isLoading) { <span class="fn">EsdiacLoadingIndicator</span>() }
    <span class="kw">else</span> { <span class="fn">LazyColumn</span> { items(uiState.offers) { <span class="fn">EsdiacOfferTile</span>(it, viewModel::<span class="fn">onOfferSelected</span>) } } }
}
  </div>
</section>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• NAVIGATION â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="p-nav" class="panel">
  <p class="sec">Decompose Navigation Tree</p>
  <div class="nav-tree">
    <div class="nav-node nn-root">RootComponent</div>
    <div class="vline"></div>
    <div class="hrow">
      <div class="branch">
        <div class="nav-node nn-auth">AuthComponent</div>
        <div class="vline"></div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;justify-content:center">
          <div class="nav-node nn-sub">Splash</div>
          <div class="nav-node nn-sub">GetStarted</div>
          <div class="nav-node nn-sub">Login</div>
          <div class="nav-node nn-sub">OTP</div>
          <div class="nav-node nn-sub">Register</div>
        </div>
      </div>
      <div style="padding-top:20px;color:var(--border);font-size:22px;padding-inline:8px">Â·</div>
      <div class="branch">
        <div class="nav-node nn-main">MainComponent (BottomNav)</div>
        <div class="vline"></div>
        <div style="display:flex;gap:10px;flex-wrap:wrap;justify-content:center;align-items:flex-start">
          <div class="branch"><div class="nav-node nn-tab" style="color:var(--muted)">Home</div><div class="vline"></div><div class="nav-node nn-sub">HomeScreen</div></div>
          <div class="branch">
            <div class="nav-node nn-tab" style="color:var(--cyan)">Call</div>
            <div class="vline"></div>
            <div style="display:flex;gap:6px">
              <div class="nav-node nn-sub">History</div>
              <div class="nav-node nn-sub">Contacts</div>
              <div class="nav-node nn-sub" style="color:var(--cyan);border-color:rgba(56,201,232,.5)">Dialpadâ†—</div>
              <div class="nav-node nn-sub" style="color:var(--pink);border-color:rgba(244,114,182,.5)">ActiveCall</div>
            </div>
          </div>
          <div class="branch">
            <div class="nav-node nn-tab" style="color:var(--green)">Data eSIM</div>
            <div class="vline"></div>
            <div style="display:flex;gap:8px;align-items:flex-start">
              <div class="branch"><div class="nav-node nn-sub">Local</div><div class="vline"></div><div class="nav-node nn-sub">Countries</div><div class="vline"></div><div class="nav-node nn-sub">Offers</div><div class="vline"></div><div class="nav-node nn-sub" style="color:var(--green);border-color:rgba(61,214,140,.4)">Detail+Buy</div></div>
              <div class="branch"><div class="nav-node nn-sub">Regional</div><div class="vline"></div><div class="nav-node nn-sub">Regions</div><div class="vline"></div><div class="nav-node nn-sub">Offers</div><div class="vline"></div><div class="nav-node nn-sub" style="color:var(--green);border-color:rgba(61,214,140,.4)">Detail+Buy</div></div>
              <div class="branch"><div class="nav-node nn-sub">Global</div><div class="vline"></div><div class="nav-node nn-sub" style="color:var(--green);border-color:rgba(61,214,140,.4)">Detail+Buy</div></div>
            </div>
          </div>
          <div class="branch">
            <div class="nav-node nn-tab" style="color:var(--orange)">Pay</div>
            <div class="vline"></div>
            <div class="branch">
              <div class="nav-node nn-sub">eGift</div><div class="vline"></div>
              <div class="nav-node nn-sub">Countries</div><div class="vline"></div>
              <div class="nav-node nn-sub">Categories</div><div class="vline"></div>
              <div class="nav-node nn-sub">Brands</div><div class="vline"></div>
              <div class="nav-node nn-sub">Offers</div><div class="vline"></div>
              <div class="nav-node nn-sub" style="color:var(--orange);border-color:rgba(255,171,74,.5)">Detail+Buy</div>
            </div>
          </div>
          <div class="branch"><div class="nav-node nn-tab" style="color:var(--muted)">Profile</div><div class="vline"></div><div class="nav-node nn-sub">Settings</div><div class="vline"></div><div class="nav-node nn-sub">Theme</div></div>
        </div>
      </div>
    </div>
  </div>

  <div class="g2" style="margin-top:36px">
    <div class="card"><div class="card-cat" style="color:var(--cyan)">Decompose + MVVM</div><div class="card-title">ViewModel inside Component</div><div class="card-body">Each Component creates its ViewModel via <code style="font-family:'JetBrains Mono',monospace;background:rgba(155,114,245,.15);padding:1px 6px;border-radius:4px;font-size:11px">retainedComponent { }</code> from Decompose. This survives Android config changes and iOS view recreation automatically.</div></div>
    <div class="card"><div class="card-cat" style="color:var(--green)">Type-safe Navigation</div><div class="card-title">Sealed class Config per Component</div><div class="card-body">Every Component has a sealed class Config listing all possible child destinations. Navigation is compile-safe â€” no string routes, no runtime crashes from typos.</div></div>
  </div>
</section>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STACK â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="p-stack" class="panel">
  <p class="sec">Technology Stack</p>
  <div class="tech-grid">
    <div class="tech-card"><div class="tech-cat" style="color:var(--cyan)">Core Framework</div><div class="tech-name">Kotlin Multiplatform</div><div class="tech-purpose">Shared logic for Android &amp; iOS in a single Kotlin codebase. androidTarget + iosX64/iosArm64/iosSimulatorArm64.</div><div class="tech-ver">v2.1.0</div></div>
    <div class="tech-card"><div class="tech-cat" style="color:var(--cyan)">UI Framework</div><div class="tech-name">Compose Multiplatform</div><div class="tech-purpose">Shared declarative UI. One composable tree runs natively on Android and iOS via Skia.</div><div class="tech-ver">v1.7.0</div></div>
    <div class="tech-card" style="border-color:rgba(155,114,245,.3)"><div class="tech-cat" style="color:var(--purple)">Presentation</div><div class="tech-name">KMP lifecycle-viewmodel â­</div><div class="tech-purpose">JetBrains' KMP-compatible ViewModel. Shared in commonMain. Lifecycle-aware on both Android and iOS.</div><div class="tech-ver">v2.9.0</div></div>
    <div class="tech-card"><div class="tech-cat" style="color:var(--green)">Navigation</div><div class="tech-name">Decompose</div><div class="tech-purpose">Type-safe, back-stack-aware component navigation. ChildStack, ChildSlot. Works in commonMain.</div><div class="tech-ver">v3.1.0</div></div>
    <div class="tech-card"><div class="tech-cat" style="color:var(--purple)">DI</div><div class="tech-name">Koin</div><div class="tech-purpose">KMP-first, zero-reflection DI. koin-compose provides koinViewModel() in Composables.</div><div class="tech-ver">v4.0.0</div></div>
    <div class="tech-card" style="border-color:rgba(155,114,245,.3)"><div class="tech-cat" style="color:var(--purple)">Build Config</div><div class="tech-name">Build-Logic Convention Plugins â­</div><div class="tech-purpose">Included build with 7 convention plugins. Feature modules reduce to ~8 lines of build config.</div><div class="tech-ver">Gradle 8.x</div></div>
    <div class="tech-card"><div class="tech-cat" style="color:var(--orange)">Networking</div><div class="tech-name">Ktor Client</div><div class="tech-purpose">Async HTTP + WebSocket. OkHttp engine on Android, Darwin on iOS. Auth, retry, logging interceptors.</div><div class="tech-ver">v3.0.0</div></div>
    <div class="tech-card"><div class="tech-cat" style="color:var(--orange)">Serialization</div><div class="tech-name">kotlinx.serialization</div><div class="tech-purpose">Compile-time safe JSON parsing. KMP-first. Used for all DTOs.</div><div class="tech-ver">v1.7.3</div></div>
    <div class="tech-card"><div class="tech-cat" style="color:var(--green)">Local DB</div><div class="tech-name">SQLDelight 2</div><div class="tech-purpose">Type-safe SQL with Kotlin code generated at compile time. Android + iOS drivers via expect/actual.</div><div class="tech-ver">v2.0.2</div></div>
    <div class="tech-card"><div class="tech-cat" style="color:var(--green)">Preferences</div><div class="tech-name">Multiplatform Settings</div><div class="tech-purpose">Key-value storage: theme mode, auth session flags. Wraps SharedPreferences/UserDefaults.</div><div class="tech-ver">v1.2.0</div></div>
    <div class="tech-card"><div class="tech-cat" style="color:var(--cyan)">Images</div><div class="tech-name">Coil 3</div><div class="tech-purpose">KMP async image loading with disk + memory cache. Ktor3 network fetcher included.</div><div class="tech-ver">v3.0.4</div></div>
    <div class="tech-card"><div class="tech-cat" style="color:var(--purple)">Async</div><div class="tech-name">kotlinx.coroutines</div><div class="tech-purpose">viewModelScope, StateFlow for state, SharedFlow for one-time events. KMP-first.</div><div class="tech-ver">v1.9.0</div></div>
    <div class="tech-card"><div class="tech-cat" style="color:var(--muted)">Logging</div><div class="tech-name">Napier</div><div class="tech-purpose">KMP logging wrapper. Maps to Logcat on Android, os_log on iOS.</div><div class="tech-ver">v2.7.1</div></div>
    <div class="tech-card"><div class="tech-cat" style="color:var(--muted)">Static Analysis</div><div class="tech-name">Detekt</div><div class="tech-purpose">KMP-aware static analysis. Applied to all modules via esdiac.detekt convention plugin.</div><div class="tech-ver">v1.23.7</div></div>
    <div class="tech-card"><div class="tech-cat" style="color:var(--pink)">VoIP â€” Android</div><div class="tech-name">WebRTC / SIP SDK</div><div class="tech-purpose">Voice call engine. Foreground service. DTMF. Exposed via VoipEngine expect/actual.</div><div class="tech-ver">Platform</div></div>
    <div class="tech-card"><div class="tech-cat" style="color:var(--pink)">VoIP â€” iOS</div><div class="tech-name">CallKit + WebRTC</div><div class="tech-purpose">Native iOS call UI, PushKit voip notifications, background calling support.</div><div class="tech-ver">Platform</div></div>
    <div class="tech-card"><div class="tech-cat" style="color:var(--orange)">Payments</div><div class="tech-name">Stripe SDK</div><div class="tech-purpose">Tokenized payment. No card data stored. PCI DSS scope minimised.</div><div class="tech-ver">Latest</div></div>
    <div class="tech-card"><div class="tech-cat" style="color:var(--muted)">CI/CD</div><div class="tech-name">GitHub Actions</div><div class="tech-purpose">ubuntu-latest for commonTest + lint. macos-latest for iOS builds. Play Store + TestFlight deploy on tag.</div><div class="tech-ver">â€“</div></div>
  </div>
</section>

<footer>
  <span>ESDIAC TELECOMMUNICATIONS INC â€” Architecture v2.0 Â· MVVM + Build-Logic</span>
  <span>KMP 2.1 Â· Compose MP 1.7 Â· Android &amp; iOS Â· February 2026</span>
</footer>

<script>
function go(name, btn) {
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('on'));
  document.querySelectorAll('.tab').forEach(b => b.classList.remove('on'));
  document.getElementById('p-' + name).classList.add('on');
  btn.classList.add('on');
}
</script>
</body>
</html>
